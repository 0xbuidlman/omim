#include "../../base/SRC_FIRST.hpp"
#include "../../testing/testing.hpp"

#include "../sha2.hpp"

UNIT_TEST(Sha2_224)
{
  TEST_EQUAL(sha2::digest224("Hello, world!"),
             "8552D8B7A7DC5476CB9E25DEE69A8091290764B7F2A64FE6E78E9568", ());
  TEST_EQUAL(sha2::digest224(""),
             "D14A028C2A3A2BC9476102BB288234C415A2B01F828EA62AC5B3E42F", ());
}

UNIT_TEST(Sha2_256)
{
  TEST_EQUAL(sha2::digest256("Hello, world!"),
             "315F5BDB76D078C43B8AC0064E4A0164612B1FCE77C869345BFC94C75894EDD3", ());
  TEST_EQUAL(sha2::digest256(""),
             "E3B0C44298FC1C149AFBF4C8996FB92427AE41E4649B934CA495991B7852B855", ());
  char const zero[] = "\x3e\x23\xe8\x16\x00\x39\x59\x4a\x33\x89\x4f\x65\x64\xe1\xb1\x34\x8b\xbd\x7a\x00\x88\xd4\x2c\x4a\xcb\x73\xee\xae\xd5\x9c\x00\x9d";
  TEST_EQUAL(sha2::digest256("b", false),
             string(zero, ARRAY_SIZE(zero) - 1), ());
}

UNIT_TEST(Sha2_384)
{
  TEST_EQUAL(sha2::digest384("Hello, world!"),
             "55BC556B0D2FE0FCE582BA5FE07BAAFFF035653638C7AC0D5494C2A64C0BEA1CC"
             "57331C7C12A45CDBCA7F4C34A089EEB", ());
  TEST_EQUAL(sha2::digest384(""),
             "38B060A751AC96384CD9327EB1B1E36A21FDB71114BE07434C0CC7BF63F6E1DA2"
             "74EDEBFE76F65FBD51AD2F14898B95B", ());
}

UNIT_TEST(Sha2_512)
{
  TEST_EQUAL(sha2::digest512(""),
             "CF83E1357EEFB8BDF1542850D66D8007D620E4050B5715DC83F4A921D36CE9CE"
             "47D0D13C5D85F2B0FF8318D2877EEC2F63B931BD47417A81A538327AF927DA3E", ());
  TEST_EQUAL(sha2::digest512("Hello, world!"),
             "C1527CD893C124773D811911970C8FE6E857D6DF5DC9226BD8A160614C0CD963"
             "A4DDEA2B94BB7D36021EF9D865D5CEA294A82DD49A0BB269F51F6E7A57F79421", ());
}
