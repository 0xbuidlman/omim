<?xml version="1.0" encoding="UTF-8"?>
<project name="MapsWithMe" default="help">

  <target name="-exclude-text-drules">
    <exec executable="rm">
      <arg value="${asset.absolute.dir}/drules_proto.txt"/>
    </exec>
  </target>
  
  <target name="-include-text-drules">
    <exec executable="ln">
      <arg value="-s"/>
      <arg value="${mwm.data.dir}/drules_proto.txt"/>
      <arg value="${asset.absolute.dir}/drules_proto.txt"/>
    </exec>
  </target>

  <target name="release" depends="-include-text-drules, android_rules.release">
  </target>

  <target name="debug" depends="-include-text-drules, android_rules.debug">
  </target>

  <target name="-setup-production">
    <property name="out.final.file" location="${out.absolute.dir}/${ant.project.name}${mwm.market.name}-production.apk"/>
    <property name="out.packaged.file" location="${out.absolute.dir}/${ant.project.name}${mwm.market.name}-production-unsigned.apk" />
    <property name="out.unaligned.file" location="${out.absolute.dir}/${ant.project.name}${mwm.market.name}-production-unaligned.apk" />
  </target>

  <target name="-setup-release">
    <property name="out.final.file" location="${out.absolute.dir}/${ant.project.name}${mwm.market.name}-release.apk" />
    <property name="out.packaged.file" location="${out.absolute.dir}/${ant.project.name}${mwm.market.name}-release-unsigned.apk" />
    <property name="out.unaligned.file" location="${out.absolute.dir}/${ant.project.name}${mwm.market.name}-release-unaligned.apk" />
  </target>

  <target name="-setup-debug">
    <property name="out.final.file" location="${out.absolute.dir}/${ant.project.name}${mwm.market.name}-debug.apk" />
    <property name="out.packaged.file" location="${out.absolute.dir}/${ant.project.name}${mwm.market.name}-debug-unsigned.apk" />
    <property name="out.unaligned.file" location="${out.absolute.dir}/${ant.project.name}${mwm.market.name}-debug-unaligned.apk" />
  </target>

  <target name="-setup-amazon-market">
    <property name="mwm.market.name" value="-amazon"/>
    <exec executable="ln">
      <arg value="-sf"/>
      <arg value="${mwm.data.dir}/app_info_amazon.txt"/>
      <arg value="${asset.absolute.dir}/app_info.txt"/>
    </exec>
  </target>

  <target name="amazon-production" depends="-setup-amazon-market, -setup-production, production"/>
  <target name="amazon-release" depends="-setup-amazon-market, -setup-release, release"/>
  <target name="amazon-debug" depends="-setup-amazon-market, -setup-debug, debug"/>

  <target name="-setup-google-market">
    <property name="mwm.market.name" value="-google"/>
    <exec executable="ln">
      <arg value="-sf"/>
      <arg value="${mwm.data.dir}/app_info_google.txt"/>
      <arg value="${asset.absolute.dir}/app_info.txt"/>
    </exec>
  </target>

  <target name="google-production" depends="-setup-google-market, -setup-production, production"/>
  <target name="google-release" depends="-setup-google-market, -setup-release, release"/>
  <target name="google-debug" depends="-setup-google-market, -setup-debug, debug"/>

  <target name="-setup-samsung-market">
    <property name="mwm.market.name" value="-samsung"/>
    <exec executable="ln">
      <arg value="-sf"/>
      <arg value="${mwm.data.dir}/app_info_samsung.txt"/>
      <arg value="${asset.absolute.dir}/app_info.txt"/>
    </exec>
  </target>

  <target name="samsung-production" depends="-setup-samsung-market, -setup-production, production"/>
  <target name="samsung-release" depends="-setup-samsung-market, -setup-release, release"/>
  <target name="samsung-debug" depends="-setup-samsung-market, -setup-debug, debug"/>

</project>
